{"mappings":"A,Q,mB,I,E,Q,S,S,E,C,E,O,G,E,U,C,E,O,C,C,CGEO,MAAM,EAAY,KACrB,IAAM,EAAK,SAAS,aAAa,CAAC,UAC9B,GAAI,EAAG,aAAa,CAAC,WAAW,CAAC,EACzC,EAGa,EAAY,CAAC,EAAM,KAC5B,IACA,IAAM,EAAS,CAAC,yBAAyB,EAAE,EAAK,EAAE,EAAE,EAAI,MAAM,CAAC,CAC/D,SAAS,aAAa,CAAC,QAAQ,kBAAkB,CAAC,aAAc,GAChE,OAAO,UAAU,CAAC,EAAW,IACjC,EDTa,EAAQ,MAAO,EAAO,KAC/B,GAAI,CACA,IAAM,EAAM,MAAM,AAAA,EAAA,GAAM,CACpB,OAAQ,OACR,IAAK,sBACL,KAAM,CACF,MAAA,EACA,SAAA,CACJ,CACJ,EACwB,CAAA,YAApB,EAAI,IAAI,CAAC,MAAM,GACf,AAAA,EAAU,UAAW,2BACrB,OAAO,UAAU,CAAC,KACd,SAAS,MAAM,CAAC,IACpB,EAAG,MAEX,CAAE,MAAO,EAAO,CACZ,AAAA,EAAU,MAAO,EAAM,QAAQ,CAAC,IAAI,CAAC,OAAO,CAEhD,CACJ,EAEa,EAAS,UAClB,GAAI,CAKI,AAJQ,CAAA,MAAM,AAAA,EAAA,GAAM,CACpB,OAAQ,MACR,IAAK,sBACT,EAAA,EACQ,IAAI,CAAC,MAAM,CAAG,UAAW,SAAS,MAAM,CAAC,CAAA,EACrD,CAAE,MAAO,EAAO,CACZ,AAAA,EAAU,QAAS,gCACvB,CACJ,EAEa,EAAS,MAAO,EAAM,EAAO,EAAU,KAChD,GAAI,CACA,IAAM,EAAM,MAAM,AAAA,EAAA,GAAM,CACpB,OAAQ,OACR,IAAK,uBACL,KAAM,CACF,KAAA,EACA,MAAA,EACA,SAAA,EACA,gBAAA,CACJ,CACJ,EACwB,CAAA,YAApB,EAAI,IAAI,CAAC,MAAM,GACf,AAAA,EAAU,UAAW,yBACrB,OAAO,UAAU,CAAC,KACd,SAAS,MAAM,CAAC,IACpB,EAAG,MAEX,CAAE,MAAO,EAAO,CACZ,AAAA,EAAU,MAAO,EAAM,QAAQ,CAAC,IAAI,CAAC,OAAO,CAChD,CACJ,EGnCa,EAAiB,MAAO,EAAM,KACvC,GAAI,CAKA,IAAM,EAAM,MAAM,AAAA,EAAA,GAAM,CACpB,OAAQ,QACR,IANQ,AAAS,aAAT,EACN,+BACA,yBAKF,KAAA,CACJ,GAIA,GAHwB,YAApB,EAAI,IAAI,CAAC,MAAM,EACf,AAAA,EAAU,UAAW,CAAC,EAAE,EAAK,WAAW,GAAG,qBAAqB,CAAC,EAEjE,AAAS,UAAT,EACA,OAAO,EAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,AAEvC,CAAE,MAAO,EAAO,CACZ,AAAA,EAAU,MAAO,EAAM,QAAQ,CAAC,IAAI,CAAC,OAAO,CAEhD,CACJ,ECzCa,EAAW,MAAM,IAC1B,IAAM,EAAS,OAAO,oCACtB,GAAI,CAEA,IAAM,EAAU,MAAM,AAAA,EAAA,GAClB,CAAC,kCAAkC,EAAE,EAAO,CAAC,CAKjD,OAAM,EAAO,kBAAkB,CAAC,CAC5B,UAAW,EAAQ,IAAI,CAAC,OAAO,CAAC,EAAE,AACtC,EACJ,CAAE,MAAO,EAAK,CACV,QAAQ,GAAG,CAAC,GACZ,AAAA,EAAU,QAAS,EACvB,CACJ,EChBa,EAAkB,MAAO,EAAQ,EAAQ,EAAM,KACxD,GAAI,CACA,IAAM,EAAM,MAAM,AAAA,EAAA,GAAM,CACpB,OAAQ,OACR,IAAK,kBACL,KAAM,CACF,OAAA,EACA,OAAA,EACA,KAAA,EACA,KAAA,CACJ,CACJ,EACwB,CAAA,YAApB,EAAI,IAAI,CAAC,MAAM,EACf,AAAA,EAAU,UAAW,2BAE7B,CAAE,MAAO,EAAO,CACZ,AAAA,EAAU,MAAO,gDACrB,CACJ,ENbM,EAAS,SAAS,cAAc,CAAC,OACjC,EAAY,SAAS,aAAa,CAAC,iBAErC,GAEA,AGbsB,CAAA,AAAA,IACtB,IAAI,EAAM,EAAE,GAAG,CAAC,MAAO,CAAE,YAAa,CAAA,CAAM,GAG5C,EAAE,SAAS,CAAC,qDAAsD,CAC9D,QAAS,GACT,YAAa,0FACb,YAAa,EACjB,GAAG,KAAK,CAAC,GAET,IAAM,EAAS,EAAE,CACjB,EAAU,OAAO,CAAC,AAAC,IACf,EAAO,IAAI,CAAC,CAAC,EAAI,WAAW,CAAC,EAAE,CAAE,EAAI,WAAW,CAAC,EAAE,CAAC,EACpD,EAAE,MAAM,CAAC,CAAC,EAAI,WAAW,CAAC,EAAE,CAAE,EAAI,WAAW,CAAC,EAAE,CAAC,EAC5C,KAAK,CAAC,GACN,SAAS,CAAC,CAAC,OAAO,EAAE,EAAI,GAAG,CAAC,EAAE,EAAE,EAAI,WAAW,CAAC,IAAI,CAAC,CAAE,CAAE,UAAW,CAAA,CAAM,GAC1E,SAAS,EAClB,GAEA,IAAM,EAAS,EAAE,YAAY,CAAC,GAAQ,GAAG,CAAC,IAC1C,EAAI,SAAS,CAAC,GAEd,EAAI,eAAe,CAAC,OAAO,EAC/B,CAAA,EHXsB,KAAK,KAAK,CAAC,SAAS,cAAc,CAAC,OAAO,OAAO,CAAC,SAAS,GAIjF,MAAM,EAAa,SAAS,aAAa,CAAC,iBAEtC,GACA,EAAW,gBAAgB,CAAC,SAAU,AAAA,IAClC,EAAE,cAAc,GAChB,IAAM,EAAO,SAAS,cAAc,CAAC,QAAQ,KAAK,CAIlD,AAAA,EAAO,EAHO,SAAS,cAAc,CAAC,SAAS,KAAK,CACnC,SAAS,cAAc,CAAC,YAAY,KAAK,CAClC,SAAS,cAAc,CAAC,mBAAmB,KAAK,CAE5E,GAIJ,MAAM,EAAY,SAAS,aAAa,CAAC,gBAErC,GACA,EAAU,gBAAgB,CAAC,SAAU,AAAA,IACjC,EAAE,cAAc,GAGhB,AAAA,EAFc,SAAS,cAAc,CAAC,SAAS,KAAK,CACnC,SAAS,cAAc,CAAC,YAAY,KAAK,CAE9D,GAGJ,MAAM,EAAY,SAAS,aAAa,CAAC,4BAErC,GACA,EAAU,gBAAgB,CAAC,QAAS,GAGxC,MAAM,EAAe,SAAS,aAAa,CAAC,mBAExC,GACA,EAAa,gBAAgB,CAAC,SAAU,AAAA,IACpC,EAAE,cAAc,GAChB,IAAM,EAAO,IAAI,SACjB,EAAK,MAAM,CAAC,OAAQ,SAAS,cAAc,CAAC,QAAQ,KAAK,EACzD,EAAK,MAAM,CAAC,QAAS,SAAS,cAAc,CAAC,SAAS,KAAK,EAC3D,EAAK,MAAM,CAAC,QAAS,SAAS,cAAc,CAAC,SAAS,KAAK,CAAC,EAAE,EAE9D,AAAA,EAAe,EAAM,OACzB,GAGA,GACA,EAAU,gBAAgB,CAAC,SAAU,MAAO,IAExC,AADa,IAAI,WACZ,MAAM,CAAC,QAAS,SAAS,cAAc,CAAC,SAAS,KAAK,CAAC,EAAE,EAC1D,WACA,SACK,aAAa,CAAC,kBACd,YAAY,CAAC,MAAO,CAAC,WAAW,EAAE,SAAS,CAAC,EACjD,SACK,aAAa,CAAC,qBACd,YAAY,CAAC,MAAO,CAAC,WAAW,EAAE,SAAS,CAAC,EAEzD,GAGJ,MAAM,EAAmB,SAAS,aAAa,CAAC,uBAE5C,GACA,EAAiB,gBAAgB,CAAC,SAAU,MAAM,IAC9C,EAAE,cAAc,GAChB,SAAS,aAAa,CAAC,uBAAuB,WAAW,CAAG,cAC5D,IAAM,EAAkB,SAAS,cAAc,CAAC,oBAAoB,KAAK,CACnE,EAAW,SAAS,cAAc,CAAC,YAAY,KAAK,CACpD,EAAkB,SAAS,cAAc,CAAC,oBAAoB,KAAK,AAEzE,OAAM,AAAA,EAAe,CAAE,gBAAA,EAAiB,SAAA,EAAU,gBAAA,CAAgB,EAAG,YACrE,SAAS,aAAa,CAAC,uBAAuB,WAAW,CAAG,gBAC5D,SAAS,cAAc,CAAC,oBAAoB,KAAK,CAAG,GACpD,SAAS,cAAc,CAAC,YAAY,KAAK,CAAG,GAC5C,SAAS,cAAc,CAAC,oBAAoB,KAAK,CAAG,EACxD,GAGJ,MAAM,EAAU,SAAS,cAAc,CAAC,aAEpC,GACA,EAAQ,gBAAgB,CAAC,QAAS,AAAA,IAC9B,EAAE,MAAM,CAAC,WAAW,CAAG,gBAEvB,GAAM,CAAA,OAAE,CAAM,CAAE,CAAG,EAAE,MAAM,CAAC,OAAO,CACnC,AAAA,EAAS,EACb,GAEJ,MAAM,EAAa,SAAS,aAAa,CAAC,iBAEtC,GACA,EAAW,gBAAgB,CAAC,SAAU,MAAM,IACxC,EAAE,cAAc,GAChB,IAAM,EAAS,SAAS,cAAc,CAAC,UAAU,KAAK,CAChD,EAAS,SAAS,cAAc,CAAC,UAAU,KAAK,CAChD,CAAA,KAAE,CAAI,CAAA,KAAE,CAAI,CAAE,CAAG,KAAK,KAAK,CAAC,EAAW,OAAO,CAAC,GAAG,CACxD,OAAM,AAAA,EAAgB,EAAQ,EAAQ,EAAM,GAE5C,SAAS,cAAc,CAAC,UAAU,KAAK,CAAG,GAC1C,SAAS,cAAc,CAAC,UAAU,KAAK,CAAG,EAC9C","sources":["<anon>","public/js/index.js","public/js/login.js","public/js/alerts.js","public/js/leaflet.js","public/js/updateSetting.js","public/js/stripe.js","public/js/review.js"],"sourcesContent":["require(\"@babel/polyfill\");\nvar $cnf0l$axios = require(\"axios\");\n\n\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\n/* eslint-disable */ \n/* eslint-disable */ \n/* eslint-disable */ const $7dc87b7f457e655a$export$516836c6a9dfc573 = ()=>{\n    const el = document.querySelector(\".alert\");\n    if (el) el.parentElement.removeChild(el);\n};\nconst $7dc87b7f457e655a$export$de026b00723010c1 = (type, msg)=>{\n    $7dc87b7f457e655a$export$516836c6a9dfc573();\n    const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n    document.querySelector(\"body\").insertAdjacentHTML(\"afterbegin\", markup);\n    window.setTimeout($7dc87b7f457e655a$export$516836c6a9dfc573, 5000);\n};\n\n\nconst $bf5b431e6a69fea8$export$596d806903d1f59e = async (email, password)=>{\n    try {\n        const res = await (0, ($parcel$interopDefault($cnf0l$axios)))({\n            method: \"POST\",\n            url: \"/api/v1/users/login\",\n            data: {\n                email: email,\n                password: password\n            }\n        });\n        if (res.data.status === \"success\") {\n            (0, $7dc87b7f457e655a$export$de026b00723010c1)(\"success\", \"Logged in successfully!\");\n            window.setTimeout(()=>{\n                location.assign(\"/\");\n            }, 1500);\n        }\n    } catch (error) {\n        (0, $7dc87b7f457e655a$export$de026b00723010c1)(\"err\", error.response.data.message);\n    }\n};\nconst $bf5b431e6a69fea8$export$a0973bcfe11b05c9 = async ()=>{\n    try {\n        const res = await (0, ($parcel$interopDefault($cnf0l$axios)))({\n            method: \"GET\",\n            url: \"/api/v1/users/logout\"\n        });\n        res.data.status = \"success\";\n        location.reload(true);\n    } catch (error) {\n        (0, $7dc87b7f457e655a$export$de026b00723010c1)(\"error\", \"Error logging out! Try again.\");\n    }\n};\nconst $bf5b431e6a69fea8$export$7200a869094fec36 = async (name, email, password, passwordConfirm)=>{\n    try {\n        const res = await (0, ($parcel$interopDefault($cnf0l$axios)))({\n            method: \"POST\",\n            url: \"/api/v1/users/signup\",\n            data: {\n                name: name,\n                email: email,\n                password: password,\n                passwordConfirm: passwordConfirm\n            }\n        });\n        if (res.data.status === \"success\") {\n            (0, $7dc87b7f457e655a$export$de026b00723010c1)(\"success\", \"Sign up successfully!\");\n            window.setTimeout(()=>{\n                location.assign(\"/\");\n            }, 1500);\n        }\n    } catch (error) {\n        (0, $7dc87b7f457e655a$export$de026b00723010c1)(\"err\", error.response.data.message);\n    }\n};\n\n\n/* eslint-disable */ const $b65541e07a62170e$export$4c5dd147b21b9176 = (locations)=>{\n    let map = L.map(\"map\", {\n        zoomControl: false\n    }); //to disable + - zoom\n    // var map = L.map('map', { zoomControl: false }).setView([31.111745, -118.113491], );\n    L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\n        maxZoom: 20,\n        attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n        crossOrigin: \"\"\n    }).addTo(map);\n    const points = [];\n    locations.forEach((loc)=>{\n        points.push([\n            loc.coordinates[1],\n            loc.coordinates[0]\n        ]);\n        L.marker([\n            loc.coordinates[1],\n            loc.coordinates[0]\n        ]).addTo(map).bindPopup(`<p>Day ${loc.day}: ${loc.description}</p>`, {\n            autoClose: false\n        }).openPopup();\n    });\n    const bounds = L.latLngBounds(points).pad(0.5);\n    map.fitBounds(bounds);\n    map.scrollWheelZoom.disable(); //to disable zoom by mouse wheel\n};\n\n\n/* eslint-disable */ \n\nconst $f10a946384e2fe45$export$f558026a994b6051 = async (data, type)=>{\n    try {\n        const url = type === \"password\" ? \"/api/v1/users/updatePassword\" : \"/api/v1/users/updateMe\";\n        const res = await (0, ($parcel$interopDefault($cnf0l$axios)))({\n            method: \"PATCH\",\n            url: url,\n            data: data\n        });\n        if (res.data.status === \"success\") (0, $7dc87b7f457e655a$export$de026b00723010c1)(\"success\", `${type.toUpperCase()} updated successfully`);\n        if (type === \"photo\") return res.data.data.user.photo;\n    } catch (error) {\n        (0, $7dc87b7f457e655a$export$de026b00723010c1)(\"err\", error.response.data.message);\n    }\n};\n\n\n/* eslint-disable */ \n\nconst $9fd71c92b6f885af$export$8d5bdbf26681c0c2 = async (tourId)=>{\n    const stripe = Stripe(\"pk_test_oKhSR5nslBRnBZpjO6KuzZeX\");\n    try {\n        // 1) Get checkout session from API\n        const session = await (0, ($parcel$interopDefault($cnf0l$axios)))(`/api/v1/bookings/checkout-session/${tourId}`);\n        // console.log(session);\n        // 2) Create checkout form + charge credit card\n        await stripe.redirectToCheckout({\n            sessionId: session.data.session.id\n        });\n    } catch (err) {\n        console.log(err);\n        (0, $7dc87b7f457e655a$export$de026b00723010c1)(\"error\", err);\n    }\n};\n\n\n/* eslint-disable */ \n\nconst $4867bed961f21f10$export$79c1e2feb2d469ac = async (rating, review, user, tour)=>{\n    try {\n        const res = await (0, ($parcel$interopDefault($cnf0l$axios)))({\n            method: \"POST\",\n            url: \"/api/v1/reviews\",\n            data: {\n                rating: rating,\n                review: review,\n                tour: tour,\n                user: user\n            }\n        });\n        if (res.data.status === \"success\") (0, $7dc87b7f457e655a$export$de026b00723010c1)(\"success\", \"Review was successfully!\");\n    } catch (error) {\n        (0, $7dc87b7f457e655a$export$de026b00723010c1)(\"err\", \"You can only write one review for every tours\");\n    }\n};\n\n\nconst $407eccdc61ba7a94$var$mapBox = document.getElementById(\"map\");\nconst $407eccdc61ba7a94$var$fileInput = document.querySelector(\".form__upload\");\nif ($407eccdc61ba7a94$var$mapBox) {\n    const locations = JSON.parse(document.getElementById(\"map\").dataset.locations);\n    (0, $b65541e07a62170e$export$4c5dd147b21b9176)(locations);\n}\nconst $407eccdc61ba7a94$var$signupForm = document.querySelector(\".form--signup\");\nif ($407eccdc61ba7a94$var$signupForm) $407eccdc61ba7a94$var$signupForm.addEventListener(\"submit\", (e)=>{\n    e.preventDefault();\n    const name = document.getElementById(\"name\").value;\n    const email = document.getElementById(\"email\").value;\n    const password = document.getElementById(\"password\").value;\n    const passwordConfirm = document.getElementById(\"passwordConfirm\").value;\n    (0, $bf5b431e6a69fea8$export$7200a869094fec36)(name, email, password, passwordConfirm);\n});\nconst $407eccdc61ba7a94$var$loginForm = document.querySelector(\".form--login\");\nif ($407eccdc61ba7a94$var$loginForm) $407eccdc61ba7a94$var$loginForm.addEventListener(\"submit\", (e)=>{\n    e.preventDefault();\n    const email = document.getElementById(\"email\").value;\n    const password = document.getElementById(\"password\").value;\n    (0, $bf5b431e6a69fea8$export$596d806903d1f59e)(email, password);\n});\nconst $407eccdc61ba7a94$var$logOutBtn = document.querySelector(\".nav__el.nav__el--logout\");\nif ($407eccdc61ba7a94$var$logOutBtn) $407eccdc61ba7a94$var$logOutBtn.addEventListener(\"click\", (0, $bf5b431e6a69fea8$export$a0973bcfe11b05c9));\nconst $407eccdc61ba7a94$var$userDataForm = document.querySelector(\".form-user-data\");\nif ($407eccdc61ba7a94$var$userDataForm) $407eccdc61ba7a94$var$userDataForm.addEventListener(\"submit\", (e)=>{\n    e.preventDefault();\n    const form = new FormData();\n    form.append(\"name\", document.getElementById(\"name\").value);\n    form.append(\"email\", document.getElementById(\"email\").value);\n    form.append(\"photo\", document.getElementById(\"photo\").files[0]);\n    (0, $f10a946384e2fe45$export$f558026a994b6051)(form, \"data\");\n});\nif ($407eccdc61ba7a94$var$fileInput) $407eccdc61ba7a94$var$fileInput.addEventListener(\"change\", async (e)=>{\n    const form = new FormData();\n    form.append(\"photo\", document.getElementById(\"photo\").files[0]);\n    if (newImage) {\n        document.querySelector(\".nav__user-img\").setAttribute(\"src\", `/img/users/${newImage}`);\n        document.querySelector(\".form__user-photo\").setAttribute(\"src\", `/img/users/${newImage}`);\n    }\n});\nconst $407eccdc61ba7a94$var$userPasswordForm = document.querySelector(\".form-user-password\");\nif ($407eccdc61ba7a94$var$userPasswordForm) $407eccdc61ba7a94$var$userPasswordForm.addEventListener(\"submit\", async (e)=>{\n    e.preventDefault();\n    document.querySelector(\".btn--save-password\").textContent = \"Updating...\";\n    const passwordCurrent = document.getElementById(\"password-current\").value;\n    const password = document.getElementById(\"password\").value;\n    const passwordConfirm = document.getElementById(\"password-confirm\").value;\n    await (0, $f10a946384e2fe45$export$f558026a994b6051)({\n        passwordCurrent: passwordCurrent,\n        password: password,\n        passwordConfirm: passwordConfirm\n    }, \"password\");\n    document.querySelector(\".btn--save-password\").textContent = \"Save password\";\n    document.getElementById(\"password-current\").value = \"\";\n    document.getElementById(\"password\").value = \"\";\n    document.getElementById(\"password-confirm\").value = \"\";\n});\nconst $407eccdc61ba7a94$var$bookBtn = document.getElementById(\"book-tour\");\nif ($407eccdc61ba7a94$var$bookBtn) $407eccdc61ba7a94$var$bookBtn.addEventListener(\"click\", (e)=>{\n    e.target.textContent = \"Processing...\";\n    //destructuring\n    const { tourId: tourId } = e.target.dataset;\n    (0, $9fd71c92b6f885af$export$8d5bdbf26681c0c2)(tourId);\n});\nconst $407eccdc61ba7a94$var$reviewForm = document.querySelector(\".form--review\");\nif ($407eccdc61ba7a94$var$reviewForm) $407eccdc61ba7a94$var$reviewForm.addEventListener(\"submit\", async (e)=>{\n    e.preventDefault();\n    const review = document.getElementById(\"review\").value;\n    const rating = document.getElementById(\"rating\").value;\n    const { user: user, tour: tour } = JSON.parse($407eccdc61ba7a94$var$reviewForm.dataset.ids);\n    await (0, $4867bed961f21f10$export$79c1e2feb2d469ac)(rating, review, user, tour);\n    document.getElementById(\"review\").value = \"\";\n    document.getElementById(\"rating\").value = \"\";\n});\n\n\n//# sourceMappingURL=index.js.map\n","/* eslint-disable */\r\n\r\nimport '@babel/polyfill';\r\nimport { signup, login, logout } from './login';\r\nimport { displayMap } from './leaflet';\r\nimport { updateSettings } from './updateSetting';\r\nimport { bookTour } from './stripe';\r\nimport { reviewAndRating } from './review';\r\n\r\n\r\nconst mapBox = document.getElementById('map');\r\nconst fileInput = document.querySelector('.form__upload');\r\n\r\nif (mapBox) {\r\n    const locations = JSON.parse(document.getElementById('map').dataset.locations);\r\n    displayMap(locations);\r\n}\r\n\r\nconst signupForm = document.querySelector('.form--signup');\r\n\r\nif (signupForm) {\r\n    signupForm.addEventListener('submit', e => {\r\n        e.preventDefault();\r\n        const name = document.getElementById('name').value;\r\n        const email = document.getElementById('email').value;\r\n        const password = document.getElementById('password').value;\r\n        const passwordConfirm = document.getElementById('passwordConfirm').value;\r\n        signup(name, email, password, passwordConfirm);\r\n    });\r\n}\r\n\r\n\r\nconst loginForm = document.querySelector('.form--login');\r\n\r\nif (loginForm) {\r\n    loginForm.addEventListener('submit', e => {\r\n        e.preventDefault();\r\n        const email = document.getElementById('email').value;\r\n        const password = document.getElementById('password').value;\r\n        login(email, password);\r\n    });\r\n}\r\n\r\nconst logOutBtn = document.querySelector('.nav__el.nav__el--logout');\r\n\r\nif (logOutBtn) {\r\n    logOutBtn.addEventListener('click', logout);\r\n}\r\n\r\nconst userDataForm = document.querySelector('.form-user-data');\r\n\r\nif (userDataForm) {\r\n    userDataForm.addEventListener('submit', e => {\r\n        e.preventDefault();\r\n        const form = new FormData();\r\n        form.append('name', document.getElementById('name').value);\r\n        form.append('email', document.getElementById('email').value);\r\n        form.append('photo', document.getElementById('photo').files[0]);\r\n\r\n        updateSettings(form, 'data');\r\n    });\r\n}\r\n\r\nif (fileInput) {\r\n    fileInput.addEventListener('change', async (e) => {\r\n        const form = new FormData();\r\n        form.append('photo', document.getElementById('photo').files[0]);\r\n        if (newImage) {\r\n            document\r\n                .querySelector('.nav__user-img')\r\n                .setAttribute('src', `/img/users/${newImage}`);\r\n            document\r\n                .querySelector('.form__user-photo')\r\n                .setAttribute('src', `/img/users/${newImage}`);\r\n        }\r\n    });\r\n}\r\n\r\nconst userPasswordForm = document.querySelector('.form-user-password');\r\n\r\nif (userPasswordForm) {\r\n    userPasswordForm.addEventListener('submit', async e => {\r\n        e.preventDefault();\r\n        document.querySelector('.btn--save-password').textContent = 'Updating...';\r\n        const passwordCurrent = document.getElementById('password-current').value;\r\n        const password = document.getElementById('password').value;\r\n        const passwordConfirm = document.getElementById('password-confirm').value;\r\n\r\n        await updateSettings({ passwordCurrent, password, passwordConfirm }, 'password');\r\n        document.querySelector('.btn--save-password').textContent = 'Save password';\r\n        document.getElementById('password-current').value = '';\r\n        document.getElementById('password').value = '';\r\n        document.getElementById('password-confirm').value = '';\r\n    })\r\n}\r\n\r\nconst bookBtn = document.getElementById('book-tour');\r\n\r\nif (bookBtn)\r\n    bookBtn.addEventListener('click', e => {\r\n        e.target.textContent = 'Processing...';\r\n        //destructuring\r\n        const { tourId } = e.target.dataset;\r\n        bookTour(tourId);\r\n    })\r\n\r\nconst reviewForm = document.querySelector('.form--review');\r\n\r\nif (reviewForm) {\r\n    reviewForm.addEventListener('submit', async e => {\r\n        e.preventDefault();\r\n        const review = document.getElementById('review').value;\r\n        const rating = document.getElementById('rating').value;\r\n        const { user, tour } = JSON.parse(reviewForm.dataset.ids);\r\n        await reviewAndRating(rating, review, user, tour);\r\n\r\n        document.getElementById('review').value = '';\r\n        document.getElementById('rating').value = '';\r\n    })\r\n}","/* eslint-disable */\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const login = async (email, password) => {\r\n    try {\r\n        const res = await axios({\r\n            method: 'POST',\r\n            url: '/api/v1/users/login',\r\n            data: {\r\n                email,\r\n                password\r\n            }\r\n        });\r\n        if (res.data.status === 'success') {\r\n            showAlert('success', 'Logged in successfully!');\r\n            window.setTimeout(() => {\r\n                location.assign('/');\r\n            }, 1500);\r\n        }\r\n    } catch (error) {\r\n        showAlert('err', error.response.data.message);\r\n\r\n    }\r\n}\r\n\r\nexport const logout = async () => {\r\n    try {\r\n        const res = await axios({\r\n            method: 'GET',\r\n            url: '/api/v1/users/logout',\r\n        });\r\n        if (res.data.status = 'success') location.reload(true);\r\n    } catch (error) {\r\n        showAlert('error', 'Error logging out! Try again.');\r\n    }\r\n}\r\n\r\nexport const signup = async (name, email, password, passwordConfirm) => {\r\n    try {\r\n        const res = await axios({\r\n            method: 'POST',\r\n            url: '/api/v1/users/signup',\r\n            data: {\r\n                name,\r\n                email,\r\n                password,\r\n                passwordConfirm\r\n            }\r\n        });\r\n        if (res.data.status === 'success') {\r\n            showAlert('success', 'Sign up successfully!');\r\n            window.setTimeout(() => {\r\n                location.assign('/');\r\n            }, 1500);\r\n        }\r\n    } catch (error) {\r\n        showAlert('err', error.response.data.message);\r\n    }\r\n}","/* eslint-disable */\r\n\r\nexport const hideAlert = () => {\r\n    const el = document.querySelector('.alert');\r\n    if (el) el.parentElement.removeChild(el);\r\n};\r\n\r\n// type is 'success' or 'error'\r\nexport const showAlert = (type, msg) => {\r\n    hideAlert();\r\n    const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\r\n    document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n    window.setTimeout(hideAlert, 5000);\r\n};","/* eslint-disable */\r\n\r\nexport const displayMap = locations => {\r\n    let map = L.map('map', { zoomControl: false });  //to disable + - zoom\r\n    // var map = L.map('map', { zoomControl: false }).setView([31.111745, -118.113491], );\r\n\r\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n        maxZoom: 20,\r\n        attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n        crossOrigin: \"\"\r\n    }).addTo(map);\r\n\r\n    const points = [];\r\n    locations.forEach((loc) => {\r\n        points.push([loc.coordinates[1], loc.coordinates[0]]);\r\n        L.marker([loc.coordinates[1], loc.coordinates[0]])\r\n            .addTo(map)\r\n            .bindPopup(`<p>Day ${loc.day}: ${loc.description}</p>`, { autoClose: false })\r\n            .openPopup();\r\n    });\r\n\r\n    const bounds = L.latLngBounds(points).pad(0.5);\r\n    map.fitBounds(bounds);\r\n\r\n    map.scrollWheelZoom.disable();  //to disable zoom by mouse wheel\r\n}\r\n","/* eslint-disable */\r\n\r\nimport { showAlert } from './alerts';\r\nimport axios from 'axios';\r\n\r\n// export const updateData = async (name, email) => {\r\n//     try {\r\n//         const res = await axios({\r\n//             method: 'PATCH',\r\n//             url: 'http://127.0.0.1:3000/api/v1/users/updateMe',\r\n//             data: {\r\n//                 name,\r\n//                 email\r\n//             }\r\n//         });\r\n//         if (res.data.status === 'success') {\r\n//             showAlert('success', 'Data updated successfully');\r\n//         }\r\n//     } catch (error) {\r\n//         showAlert('err', error.response.data.message);\r\n\r\n//     }\r\n// }\r\n\r\nexport const updateSettings = async (data, type) => {\r\n    try {\r\n        const url = type === 'password'\r\n            ? '/api/v1/users/updatePassword'\r\n            : '/api/v1/users/updateMe';\r\n\r\n        const res = await axios({\r\n            method: 'PATCH',\r\n            url,\r\n            data\r\n        })\r\n        if (res.data.status === 'success') {\r\n            showAlert('success', `${type.toUpperCase()} updated successfully`);\r\n        }\r\n        if (type === 'photo') {\r\n            return res.data.data.user.photo;\r\n        }\r\n    } catch (error) {\r\n        showAlert('err', error.response.data.message);\r\n\r\n    }\r\n}","/* eslint-disable */\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const bookTour = async tourId => {\r\n    const stripe = Stripe('pk_test_oKhSR5nslBRnBZpjO6KuzZeX');\r\n    try {\r\n        // 1) Get checkout session from API\r\n        const session = await axios(\r\n            `/api/v1/bookings/checkout-session/${tourId}`\r\n        );\r\n        // console.log(session);\r\n\r\n        // 2) Create checkout form + charge credit card\r\n        await stripe.redirectToCheckout({\r\n            sessionId: session.data.session.id\r\n        });\r\n    } catch (err) {\r\n        console.log(err);\r\n        showAlert('error', err);\r\n    }\r\n};","/* eslint-disable */\r\n\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const reviewAndRating = async (rating, review, user, tour) => {\r\n    try {\r\n        const res = await axios({\r\n            method: 'POST',\r\n            url: '/api/v1/reviews',\r\n            data: {\r\n                rating,\r\n                review,\r\n                tour,\r\n                user\r\n            }\r\n        });\r\n        if (res.data.status === 'success') {\r\n            showAlert('success', 'Review was successfully!');\r\n        }\r\n    } catch (error) {\r\n        showAlert('err', 'You can only write one review for every tours');\r\n    }\r\n}"],"names":["require","$cnf0l$axios","$parcel$interopDefault","a","__esModule","default","$7dc87b7f457e655a$export$516836c6a9dfc573","el","document","querySelector","parentElement","removeChild","$7dc87b7f457e655a$export$de026b00723010c1","type","msg","markup","insertAdjacentHTML","window","setTimeout","$bf5b431e6a69fea8$export$596d806903d1f59e","email","password","res","method","url","data","status","location","assign","error","response","message","$bf5b431e6a69fea8$export$a0973bcfe11b05c9","reload","$bf5b431e6a69fea8$export$7200a869094fec36","name","passwordConfirm","$f10a946384e2fe45$export$f558026a994b6051","toUpperCase","user","photo","$9fd71c92b6f885af$export$8d5bdbf26681c0c2","tourId","stripe","Stripe","session","redirectToCheckout","sessionId","id","err","console","log","$4867bed961f21f10$export$79c1e2feb2d469ac","rating","review","tour","$407eccdc61ba7a94$var$mapBox","getElementById","$407eccdc61ba7a94$var$fileInput","locations","map","L","zoomControl","tileLayer","maxZoom","attribution","crossOrigin","addTo","points","forEach","loc","push","coordinates","marker","bindPopup","day","description","autoClose","openPopup","bounds","latLngBounds","pad","fitBounds","scrollWheelZoom","disable","JSON","parse","dataset","$407eccdc61ba7a94$var$signupForm","addEventListener","e","preventDefault","value","$407eccdc61ba7a94$var$loginForm","$407eccdc61ba7a94$var$logOutBtn","$407eccdc61ba7a94$var$userDataForm","form","FormData","append","files","newImage","setAttribute","$407eccdc61ba7a94$var$userPasswordForm","textContent","passwordCurrent","$407eccdc61ba7a94$var$bookBtn","target","$407eccdc61ba7a94$var$reviewForm","ids"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}